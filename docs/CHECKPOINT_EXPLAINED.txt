"""
Visual demonstration of checkpoint system
Shows how each prediction is saved immediately
"""

print("""
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    CHECKPOINT SYSTEM - HOW IT WORKS                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ KONSEP: Setiap 1 prediksi langsung disimpan ke database

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TANPA CHECKPOINT (OLD WAY - BAD!)                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚ Test 1, Run 1 â†’ Run API â†’ â³ Wait...                                     â”‚
â”‚ Test 1, Run 2 â†’ Run API â†’ â³ Wait...                                     â”‚
â”‚ Test 1, Run 3 â†’ Run API â†’ âŒ ERROR! (internet putus)                    â”‚
â”‚                                                                          â”‚
â”‚ Resume:                                                                  â”‚
â”‚ Test 1, Run 1 â†’ Run API â†’ â³ Wait... (REPEAT!)                          â”‚
â”‚ Test 1, Run 2 â†’ Run API â†’ â³ Wait... (REPEAT!)                          â”‚
â”‚ Test 1, Run 3 â†’ Run API â†’ â³ Wait...                                     â”‚
â”‚                                                                          â”‚
â”‚ âŒ Problem: Harus ulang semua! Waste API calls!                         â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DENGAN CHECKPOINT (NEW WAY - GOOD!)                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚ Test 1, Run 1 â†’ Run API â†’ âœ… SAVE TO DB immediately                      â”‚
â”‚ Test 1, Run 2 â†’ Run API â†’ âœ… SAVE TO DB immediately                      â”‚
â”‚ Test 1, Run 3 â†’ Run API â†’ âŒ ERROR! (internet putus)                    â”‚
â”‚                                                                          â”‚
â”‚ Resume:                                                                  â”‚
â”‚ Test 1, Run 1 â†’ Check DB â†’ âœ… Found! â†’ â­ï¸  SKIP                          â”‚
â”‚ Test 1, Run 2 â†’ Check DB â†’ âœ… Found! â†’ â­ï¸  SKIP                          â”‚
â”‚ Test 1, Run 3 â†’ Check DB â†’ âŒ Not found â†’ Run API â†’ âœ… SAVE TO DB        â”‚
â”‚                                                                          â”‚
â”‚ âœ… Solution: Skip yang sudah ada! No wasted API calls!                  â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CODE FLOW                                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚ for run in range(1, 5):  # 4 runs                                       â”‚
â”‚     # 1. CHECK IF EXISTS                                                â”‚
â”‚     if db.is_prediction_complete(test_id, run, model):                  â”‚
â”‚         skipped += 1                                                     â”‚
â”‚         continue  # â­ï¸ SKIP!                                             â”‚
â”‚                                                                          â”‚
â”‚     # 2. RUN PREDICTION                                                 â”‚
â”‚     result = test_single_sample(test_id, features, model)               â”‚
â”‚                                                                          â”‚
â”‚     # 3. SAVE IMMEDIATELY (âš¡ KEY PART!)                                 â”‚
â”‚     db.save_prediction(test_id, run, model, result, ground_truth)       â”‚
â”‚                                                                          â”‚
â”‚     # 4. RATE LIMITING                                                  â”‚
â”‚     time.sleep(0.5)                                                      â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DATABASE SCHEMA                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚ CREATE TABLE predictions (                                              â”‚
â”‚     id INTEGER PRIMARY KEY,                                             â”‚
â”‚     test_id INTEGER,        -- Sample ID (0-99)                         â”‚
â”‚     run_id INTEGER,         -- Run number (1-4)                         â”‚
â”‚     model TEXT,             -- gpt/gemini/qwen                          â”‚
â”‚     prediction TEXT,        -- Yes/No                                   â”‚
â”‚     prediction_binary INT,  -- 0/1                                      â”‚
â”‚     justification TEXT,     -- Full medical explanation                 â”‚
â”‚     raw_response TEXT,      -- Complete LLM response                    â”‚
â”‚     ground_truth INTEGER,   -- True label (0/1)                         â”‚
â”‚     timestamp TEXT,         -- ISO timestamp                            â”‚
â”‚     error TEXT,             -- Error message if failed                  â”‚
â”‚     UNIQUE(test_id, run_id, model)  -- âš¡ NO DUPLICATES!                â”‚
â”‚ );                                                                       â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ REAL EXAMPLE FROM TEST                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚ Phase 1: Run GPT & Gemini                                               â”‚
â”‚   âœ… GPT Test 0, Run 1 saved â†’ 2025-12-08T14:26:21                       â”‚
â”‚   âœ… GPT Test 0, Run 2 saved â†’ 2025-12-08T14:26:25                       â”‚
â”‚   âœ… GPT Test 0, Run 3 saved â†’ 2025-12-08T14:26:29                       â”‚
â”‚   âœ… GPT Test 0, Run 4 saved â†’ 2025-12-08T14:26:34                       â”‚
â”‚   âœ… Gemini Test 0, Run 1 saved â†’ 2025-12-08T14:26:51                    â”‚
â”‚   âœ… Gemini Test 0, Run 2 saved â†’ 2025-12-08T14:26:53                    â”‚
â”‚   âœ… Gemini Test 0, Run 3 saved â†’ 2025-12-08T14:26:56                    â”‚
â”‚   âœ… Gemini Test 0, Run 4 saved â†’ 2025-12-08T14:26:59                    â”‚
â”‚                                                                          â”‚
â”‚ Phase 3: Resume with all 3 models                                       â”‚
â”‚   â­ï¸  GPT Test 0, Runs 1-4: SKIPPED (already in DB)                     â”‚
â”‚   â­ï¸  Gemini Test 0, Runs 1-4: SKIPPED (already in DB)                  â”‚
â”‚   âœ… Qwen Test 0, Run 1 saved â†’ 2025-12-08T14:27:13                      â”‚
â”‚   âœ… Qwen Test 0, Run 2 saved â†’ 2025-12-08T14:27:17                      â”‚
â”‚   âœ… Qwen Test 0, Run 3 saved â†’ 2025-12-08T14:27:21                      â”‚
â”‚   âœ… Qwen Test 0, Run 4 saved â†’ 2025-12-08T14:27:25                      â”‚
â”‚                                                                          â”‚
â”‚ Result: 12 total predictions, 8 skipped, 4 new                          â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BENEFITS                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚ âœ… GRANULAR CHECKPOINT                                                   â”‚
â”‚    â†’ Setiap 1 prediksi = 1 checkpoint                                   â”‚
â”‚    â†’ Bukan per sample, tapi per run!                                    â”‚
â”‚                                                                          â”‚
â”‚ âœ… IMMEDIATE SAVE                                                        â”‚
â”‚    â†’ db.save_prediction() dipanggil langsung setelah API response       â”‚
â”‚    â†’ Tidak menunggu semua run selesai                                   â”‚
â”‚                                                                          â”‚
â”‚ âœ… AUTO-SKIP                                                             â”‚
â”‚    â†’ Check DB sebelum run                                               â”‚
â”‚    â†’ Skip jika sudah ada                                                â”‚
â”‚                                                                          â”‚
â”‚ âœ… NO DUPLICATES                                                         â”‚
â”‚    â†’ UNIQUE constraint di database                                      â”‚
â”‚    â†’ Tidak mungkin save 2x untuk (test_id, run_id, model) yang sama    â”‚
â”‚                                                                          â”‚
â”‚ âœ… ERROR SAFE                                                            â”‚
â”‚    â†’ Jika error di Run 3, Run 1 & 2 tetap tersimpan                    â”‚
â”‚    â†’ Resume hanya perlu run yang belum selesai                          â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                          â•‘
â•‘  ğŸ¯ KESIMPULAN:                                                          â•‘
â•‘                                                                          â•‘
â•‘  Sistem ini menyimpan SETIAP 1 PREDIKSI INDIVIDUAL ke database          â•‘
â•‘  secara REAL-TIME, sehingga jika error di tengah jalan,                 â•‘
â•‘  resume hanya perlu lanjut dari prediksi yang belum selesai.            â•‘
â•‘                                                                          â•‘
â•‘  Granularity: PER RUN, bukan per sample!                                â•‘
â•‘                                                                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
""")
